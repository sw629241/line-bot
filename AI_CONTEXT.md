# AI 開發上下文記錄

## 專案當前狀態
### 1. 核心功能概述
- 雙 webhook 架構 (sxi-bot, fas-bot)
- GPT 整合的對話處理系統
- 基於規則的回覆機制
- 管理介面用於配置維護

### 2. 最近的重要更改
#### 管理介面優化
- **即時刪除功能**：
  * 規則刪除後立即生效，不需要額外保存
  * 前端和後端資料同步機制改善
  * 相關文件：`admin.js`, `configService.js`

- **狀態提示改進**：
  * 新增頂部通知欄（Alert）顯示操作結果
  * 支援成功/錯誤訊息自動消失（5秒）
  * 相關文件：`admin.js`, `admin.html`

#### 資料處理優化
- **設定檔案緩存**：
  * 新增 configCache 機制避免重複讀取
  * 緩存在面板切換時重置
  * 相關文件：`configService.js`

### 3. 已知問題和限制
- 舊版配置文件需要格式轉換
- 確保所有 bot 目錄具有適當的讀寫權限
- 配置保存時需注意目錄自動創建功能

## 開發重點提醒
### 1. 程式碼注意事項
- 類別設定從陣列改為物件格式：`{key: {...}}`
- 配置驗證發生在：載入、保存、測試訊息時
- 使用緩存機制避免重複讀取配置

### 2. 重要的業務邏輯
- 回覆生成使用動態比例系統 (0-100%)
- 敏感詞檢查優先於其他處理
- GPT 回應需遵循設定的語言風格

### 3. 待優化項目
- 配置文件格式轉換工具
- 錯誤處理和回饋機制
- 自動化測試覆蓋

## 系統整合注意事項
### 1. 外部服務依賴
- LINE Messaging API
- OpenAI API
- Nginx 反向代理

### 2. 關鍵配置提醒
- 環境變數完整性檢查
- SSL 證書狀態
- Webhook URL 設定

### 3. 效能考量
- 配置文件緩存機制
- 回應生成的效能優化
- 資源使用監控
